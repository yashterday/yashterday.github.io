<!DOCTYPE html>
<html>
  
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <a class="navbar-brand" href="index.html">Yash Tanna</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  
    <div class="collapse navbar-collapse" id="navbarColor01">
      <ul class="navbar-nav mr-auto">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Home<span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="projects.html">Projects</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">About</a>
        </li>
      </ul>
    </div>
  </nav>
  <body>
    <div tabindex="-1" id="notebook" class="border-box-sizing">
      <div class="container" id="notebook-container">

  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h1 id="Heart-Disease-Decision-Tree-Classifier-Model">Heart Disease Decision Tree Classifier Model<a class="anchor-link" href="#Heart-Disease-Decision-Tree-Classifier-Model">&#182;</a></h1>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="This-database-contains-76-attributes,-but-all-published-experiments-refer-to-using-a-subset-of-14-of-them.-In-particular,-the-Cleveland-database-is-the-only-one-that-has-been-used-by-ML-researchers-to-this-date.-The-&quot;target&quot;-field-refers-to-the-presence-of-heart-disease-in-the-patient.">This database contains 76 attributes, but all published experiments refer to using a subset of 14 of them. In particular, the Cleveland database is the only one that has been used by ML researchers to this date. The "target" field refers to the presence of heart disease in the patient.<a class="anchor-link" href="#This-database-contains-76-attributes,-but-all-published-experiments-refer-to-using-a-subset-of-14-of-them.-In-particular,-the-Cleveland-database-is-the-only-one-that-has-been-used-by-ML-researchers-to-this-date.-The-&quot;target&quot;-field-refers-to-the-presence-of-heart-disease-in-the-patient.">&#182;</a></h4>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h1 id="1.--Get-the-Data-Ready">1.  Get the Data Ready<a class="anchor-link" href="#1.--Get-the-Data-Ready">&#182;</a></h1>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[1]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
  <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
  <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">plt</span>
  <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
  <span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeClassifier</span>
  <span class="o">%</span><span class="k">matplotlib</span> inline
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[2]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># the heart.csv file can be found in the github along with this notebook</span>
  <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;heart.csv&#39;</span><span class="p">)</span>
  <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[2]:</div>



  <div class="output_html rendered_html output_subarea output_execute_result">
  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }

      .dataframe tbody tr th {
          vertical-align: top;
      }

      .dataframe thead th {
          text-align: right;
      }
  </style>
  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>age</th>
        <th>sex</th>
        <th>cp</th>
        <th>trestbps</th>
        <th>chol</th>
        <th>fbs</th>
        <th>restecg</th>
        <th>thalach</th>
        <th>exang</th>
        <th>oldpeak</th>
        <th>slope</th>
        <th>ca</th>
        <th>thal</th>
        <th>target</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>63</td>
        <td>1</td>
        <td>3</td>
        <td>145</td>
        <td>233</td>
        <td>1</td>
        <td>0</td>
        <td>150</td>
        <td>0</td>
        <td>2.3</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>1</td>
      </tr>
      <tr>
        <th>1</th>
        <td>37</td>
        <td>1</td>
        <td>2</td>
        <td>130</td>
        <td>250</td>
        <td>0</td>
        <td>1</td>
        <td>187</td>
        <td>0</td>
        <td>3.5</td>
        <td>0</td>
        <td>0</td>
        <td>2</td>
        <td>1</td>
      </tr>
      <tr>
        <th>2</th>
        <td>41</td>
        <td>0</td>
        <td>1</td>
        <td>130</td>
        <td>204</td>
        <td>0</td>
        <td>0</td>
        <td>172</td>
        <td>0</td>
        <td>1.4</td>
        <td>2</td>
        <td>0</td>
        <td>2</td>
        <td>1</td>
      </tr>
      <tr>
        <th>3</th>
        <td>56</td>
        <td>1</td>
        <td>1</td>
        <td>120</td>
        <td>236</td>
        <td>0</td>
        <td>1</td>
        <td>178</td>
        <td>0</td>
        <td>0.8</td>
        <td>2</td>
        <td>0</td>
        <td>2</td>
        <td>1</td>
      </tr>
      <tr>
        <th>4</th>
        <td>57</td>
        <td>0</td>
        <td>0</td>
        <td>120</td>
        <td>354</td>
        <td>0</td>
        <td>1</td>
        <td>163</td>
        <td>1</td>
        <td>0.6</td>
        <td>2</td>
        <td>0</td>
        <td>2</td>
        <td>1</td>
      </tr>
    </tbody>
  </table>
  </div>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[3]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#double check to see if there&#39;s some balance to the amount of 1s and 0s for the targets</span>
  <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[3]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>1    165
  0    138
  Name: target, dtype: int64</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="I-converted-the-1s-and-0s-into-Yes-and-No-as-well-as-rename-the-column-to-ensure-it-would-be-easier-for-viewers-to-read-later-on.">I converted the 1s and 0s into Yes and No as well as rename the column to ensure it would be easier for viewers to read later on.<a class="anchor-link" href="#I-converted-the-1s-and-0s-into-Yes-and-No-as-well-as-rename-the-column-to-ensure-it-would-be-easier-for-viewers-to-read-later-on.">&#182;</a></h4>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[4]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">);</span>
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[5]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">);</span>
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[6]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;heart_disease&#39;</span><span class="p">})</span>
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[7]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># making sure that our values are in the correct form for our shift to a numpy array</span>
  <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[7]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>age                int64
  sex                int64
  cp                 int64
  trestbps           int64
  chol               int64
  fbs                int64
  restecg            int64
  thalach            int64
  exang              int64
  oldpeak          float64
  slope              int64
  ca                 int64
  thal               int64
  heart_disease     object
  dtype: object</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h1 id="2.--Pre-Processing">2.  Pre-Processing<a class="anchor-link" href="#2.--Pre-Processing">&#182;</a></h1>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="Get-your-arrays-ready-for-the-decision-tree-model-and-create-one-array-with-the-independent-variables-and-one-without-to-use-for-predictions-in-the-future">Get your arrays ready for the decision tree model and create one array with the independent variables and one without to use for predictions in the future<a class="anchor-link" href="#Get-your-arrays-ready-for-the-decision-tree-model-and-create-one-array-with-the-independent-variables-and-one-without-to-use-for-predictions-in-the-future">&#182;</a></h4>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[8]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#note the one-hot encoding was already present in the data set so didn&#39;t need to be done</span>
  <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;cp&#39;</span><span class="p">,</span> <span class="s1">&#39;trestbps&#39;</span><span class="p">,</span> <span class="s1">&#39;chol&#39;</span><span class="p">,</span> <span class="s1">&#39;fbs&#39;</span><span class="p">,</span> <span class="s1">&#39;restecg&#39;</span><span class="p">,</span> <span class="s1">&#39;thalach&#39;</span><span class="p">,</span> <span class="s1">&#39;exang&#39;</span><span class="p">,</span> <span class="s1">&#39;oldpeak&#39;</span><span class="p">,</span> <span class="s1">&#39;slope&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;thal&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
  <span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[8]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>array([[ 63. ,   1. ,   3. , 145. , 233. ,   1. ,   0. , 150. ,   0. ,
            2.3,   0. ,   0. ,   1. ],
        [ 37. ,   1. ,   2. , 130. , 250. ,   0. ,   1. , 187. ,   0. ,
            3.5,   0. ,   0. ,   2. ],
        [ 41. ,   0. ,   1. , 130. , 204. ,   0. ,   0. , 172. ,   0. ,
            1.4,   2. ,   0. ,   2. ],
        [ 56. ,   1. ,   1. , 120. , 236. ,   0. ,   1. , 178. ,   0. ,
            0.8,   2. ,   0. ,   2. ],
        [ 57. ,   0. ,   0. , 120. , 354. ,   0. ,   1. , 163. ,   1. ,
            0.6,   2. ,   0. ,   2. ]])</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[9]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;heart_disease&#39;</span><span class="p">]]</span>
  <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[9]:</div>



  <div class="output_html rendered_html output_subarea output_execute_result">
  <div>
  <style scoped>
      .dataframe tbody tr th:only-of-type {
          vertical-align: middle;
      }

      .dataframe tbody tr th {
          vertical-align: top;
      }

      .dataframe thead th {
          text-align: right;
      }
  </style>
  <table border="1" class="dataframe">
    <thead>
      <tr style="text-align: right;">
        <th></th>
        <th>heart_disease</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>0</th>
        <td>yes</td>
      </tr>
      <tr>
        <th>1</th>
        <td>yes</td>
      </tr>
      <tr>
        <th>2</th>
        <td>yes</td>
      </tr>
      <tr>
        <th>3</th>
        <td>yes</td>
      </tr>
      <tr>
        <th>4</th>
        <td>yes</td>
      </tr>
    </tbody>
  </table>
  </div>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[10]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#### Now use the train_test split to get training and testing splits for the X and Y arrays</span>
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[11]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[12]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
  <span class="c1">#check size of each set</span>
  <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
  <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span>
  <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
  <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[12]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>(91, 1)</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h1 id="4.-Prediction-Time">4. Prediction Time<a class="anchor-link" href="#4.-Prediction-Time">&#182;</a></h1>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="We-will-be-using-a-decision-tree-classifier-model-with-an-&quot;entropy&quot;-criterion-to-have-the-tree-pick-columns-by-best-information-availability.">We will be using a decision tree classifier model with an "entropy" criterion to have the tree pick columns by best information availability.<a class="anchor-link" href="#We-will-be-using-a-decision-tree-classifier-model-with-an-&quot;entropy&quot;-criterion-to-have-the-tree-pick-columns-by-best-information-availability.">&#182;</a></h4>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[13]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">heartTree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;entropy&quot;</span><span class="p">)</span>
  <span class="n">heartTree</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[13]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>DecisionTreeClassifier(class_weight=None, criterion=&#39;entropy&#39;, max_depth=None,
                        max_features=None, max_leaf_nodes=None,
                        min_impurity_decrease=0.0, min_impurity_split=None,
                        min_samples_leaf=1, min_samples_split=2,
                        min_weight_fraction_leaf=0.0, presort=False,
                        random_state=None, splitter=&#39;best&#39;)</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[14]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">heartTree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[14]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>DecisionTreeClassifier(class_weight=None, criterion=&#39;entropy&#39;, max_depth=None,
                        max_features=None, max_leaf_nodes=None,
                        min_impurity_decrease=0.0, min_impurity_split=None,
                        min_samples_leaf=1, min_samples_split=2,
                        min_weight_fraction_leaf=0.0, presort=False,
                        random_state=None, splitter=&#39;best&#39;)</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="Using-the-model-we-just-made-with-heartTree,-we-will-now-apply-the-tree-to-the-testing-sets-to-check-how-accurate-our-model-really-is">Using the model we just made with heartTree, we will now apply the tree to the testing sets to check how accurate our model really is<a class="anchor-link" href="#Using-the-model-we-just-made-with-heartTree,-we-will-now-apply-the-tree-to-the-testing-sets-to-check-how-accurate-our-model-really-is">&#182;</a></h4>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[15]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="n">predTree</span> <span class="o">=</span> <span class="n">heartTree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
  </pre></div>

      </div>
  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[16]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="n">predTree</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
  <span class="nb">print</span> <span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt"></div>


  <div class="output_subarea output_stream output_stdout output_text">
  <pre>[&#39;yes&#39; &#39;yes&#39; &#39;yes&#39; &#39;yes&#39; &#39;yes&#39;]
      heart_disease
  245            no
  162           yes
  10            yes
  161           yes
  73            yes
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h4 id="It-seems-like-the-model-is-not-100%-accurate-but-lets-check-the-accuracy-score-to-get-an-idea-of-all-the-predictions">It seems like the model is not 100% accurate but lets check the accuracy score to get an idea of all the predictions<a class="anchor-link" href="#It-seems-like-the-model-is-not-100%-accurate-but-lets-check-the-accuracy-score-to-get-an-idea-of-all-the-predictions">&#182;</a></h4>
  </div>
  </div>
  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[17]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">metrics</span>
  <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">mean_squared_error</span>
  <span class="n">x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">predTree</span><span class="p">)</span>

  <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DecisionTrees&#39;s Accuracy: &quot;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">predTree</span><span class="p">))</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt"></div>


  <div class="output_subarea output_stream output_stdout output_text">
  <pre>DecisionTrees&#39;s Accuracy:  0.8131868131868132
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[18]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">preprocessing</span>
  <span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">OneHotEncoder</span>

  <span class="n">enc</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">OneHotEncoder</span><span class="p">()</span>

  <span class="n">enc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

  <span class="n">onehotlabels</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
  <span class="n">onehotlabels</span><span class="o">.</span><span class="n">shape</span>

  <span class="n">enc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="n">onehotlabels2</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
  <span class="n">onehotlabels2</span><span class="o">.</span><span class="n">shape</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt output_prompt">Out[18]:</div>




  <div class="output_text output_subarea output_execute_result">
  <pre>(91, 2)</pre>
  </div>

  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing code_cell rendered">
  <div class="input">
  <div class="prompt input_prompt">In&nbsp;[19]:</div>
  <div class="inner_cell">
      <div class="input_area">
  <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">y_actual</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_actual</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE score on train data:&#39;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">onehotlabels</span><span class="p">,</span> <span class="n">onehotlabels2</span><span class="p">))</span>
  </pre></div>

      </div>
  </div>
  </div>

  <div class="output_wrapper">
  <div class="output">


  <div class="output_area">

      <div class="prompt"></div>


  <div class="output_subarea output_stream output_stdout output_text">
  <pre>RMSE score on train data:
  0.4322189107537832
  </pre>
  </div>
  </div>

  </div>
  </div>

  </div>
  <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
  </div><div class="inner_cell">
  <div class="text_cell_render border-box-sizing rendered_html">
  <h3 id="Very-high-root-mean-squre-error,-I'll-be-coming-back-to-improve-this-model!">Very high root mean squre error, I'll be coming back to improve this model!<a class="anchor-link" href="#Very-high-root-mean-squre-error,-I'll-be-coming-back-to-improve-this-model!">&#182;</a></h3>
  </div>
  </div>
  </div>
      </div>
    </div>
  </body>
  

</html>
